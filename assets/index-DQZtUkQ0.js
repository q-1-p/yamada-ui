import{u as F}from"./index-I8sPqzTA.js";import{r as m}from"./index-ClcD9ViR.js";import{o as d,W as E,u as p,X as A,Y as b,Z as h,_ as g}from"./factory-D0ba2aB7.js";const q=s=>{const e=s.current;if(!e)return!1;const r=h(e);return!r||e.contains(r)?!1:!!g(r)},x=(s,{focusRef:e,shouldFocus:r,visible:o})=>{const t=r&&!o;d(()=>{if(!t||q(s))return;const n=e.current||s.current;n&&requestAnimationFrame(()=>{n.focus()})},[t,s,e])},L=(s,{focusRef:e,preventScroll:r,shouldFocus:o,visible:t}={preventScroll:!0,shouldFocus:!1})=>{const n=E(s)?s.current:s,l=o&&t,a=m.useRef(l),c=m.useRef(t);p(()=>{!c.current&&t&&(a.current=l),c.current=t},[t,l]);const u=m.useCallback(()=>{if(!(!t||!n||!a.current)&&(a.current=!1,!n.contains(document.activeElement)))if(e!=null&&e.current)requestAnimationFrame(()=>{var i;(i=e.current)==null||i.focus({preventScroll:r})});else{const i=A(n);i.length>0&&requestAnimationFrame(()=>{var f;(f=i[0])==null||f.focus({preventScroll:r})})}},[t,r,n,e]);d(()=>{requestAnimationFrame(()=>{u()})},[u]),F(n,"transitionend",u)},O=({ref:s,elements:e,enabled:r})=>{const o=()=>{var t;return((t=s.current)==null?void 0:t.ownerDocument)??document};F(o,"pointerdown",t=>{if(!b()||!r)return;const n=t.target,a=(e??[s]).some(c=>{const u=E(c)?c.current:c;return(u==null?void 0:u.contains(n))||u===n});o().activeElement!==n&&a&&(t.preventDefault(),n.focus())})};export{x as a,L as b,O as u};
